<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visions AI | Next-Gen Web Builder</title>
    <link rel="stylesheet" href="dashboard.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
</head>
<body>

    <!-- Main App Container -->
    <div class="app-container">
        
        <!-- Sidebar Controls -->
        <aside class="sidebar">
            <div class="logo-area">
                <h1>VISIONS<span class="ai-badge">AI</span></h1>
                <p>Generative Design Engine</p>
            </div>

            <!-- Tab Navigation -->
            <div class="tab-nav">
                <button class="tab-btn active" onclick="switchTab('create')">
                    <i class="fas fa-wand-magic-sparkles"></i> Create
                </button>
                <button class="tab-btn" onclick="switchTab('templates')">
                    <i class="fas fa-layer-group"></i> Templates
                </button>
                <button class="tab-btn" onclick="switchTab('history')">
                    <i class="fas fa-clock-rotate-left"></i> History
                </button>
            </div>

            <!-- CREATE TAB -->
            <div id="tab-create" class="tab-content active">
                <div class="control-group">
                    <label>AI MODEL KEY (GEMINI/OPENAI)</label>
                    <input type="password" id="apiKey" placeholder="Paste API Key Here (Optional)" style="border-color: var(--accent-solid);">
                    <small style="color: var(--text-muted); font-size: 10px; margin-top: 5px; display: block;">Leave empty to use Server Env Key or Offline Logic.</small>
                </div>

                <div class="control-group">
                    <label>PROJECT NAME</label>
                    <input type="text" id="projectName" value="My Future Site" placeholder="e.g. CyberStore">
                </div>

                <div class="control-group">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <label>DESCRIBE YOUR VISION</label>
                        <div class="prompt-actions">
                             <button type="button" onclick="fillSurprisePrompt()" class="icon-btn-small" title="Surprise Me">üé≤</button>
                             <button type="button" onclick="startVoiceInput()" id="micBtn" class="icon-btn-small" title="Voice Input">üé§</button>
                        </div>
                    </div>
                    <textarea id="aiPrompt" placeholder="e.g. A futuristic gaming store with neon vibes... or A cozy coffee shop for students..." style="width: 100%; height: 120px; background: rgba(255, 255, 255, 0.03); border: 1px solid var(--glass-border); border-radius: 12px; color: white; padding: 14px; font-family: inherit; resize: none;"></textarea>
                </div>

                <button class="generate-btn" onclick="generateSite()">
                    ‚ö° GENERATE SITE
                </button>
                
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <button class="action-btn" onclick="saveProject()" title="Save Project">
                        <i class="fas fa-floppy-disk"></i> Save
                    </button>
                    <button class="action-btn" onclick="showLoadModal()" title="Load Project">
                        <i class="fas fa-folder-open"></i> Load
                    </button>
                    <button class="action-btn" onclick="downloadCode()" title="Download Code">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
            </div>

            <!-- TEMPLATES TAB -->
            <div id="tab-templates" class="tab-content">
                <div class="control-group">
                    <label>READY-MADE TEMPLATES</label>
                    <div class="template-grid">
                        <div class="template-card" onclick="loadTemplate('saas')">
                            <div class="template-icon">üíº</div>
                            <h4>SaaS Platform</h4>
                            <p>Modern business app</p>
                        </div>
                        <div class="template-card" onclick="loadTemplate('gaming')">
                            <div class="template-icon">üéÆ</div>
                            <h4>Gaming Site</h4>
                            <p>Esports & tournaments</p>
                        </div>
                        <div class="template-card" onclick="loadTemplate('ecommerce')">
                            <div class="template-icon">üõçÔ∏è</div>
                            <h4>E-commerce</h4>
                            <p>Online store</p>
                        </div>
                        <div class="template-card" onclick="loadTemplate('portfolio')">
                            <div class="template-icon">üé®</div>
                            <h4>Portfolio</h4>
                            <p>Creative showcase</p>
                        </div>
                        <div class="template-card" onclick="loadTemplate('ai')">
                            <div class="template-icon">ü§ñ</div>
                            <h4>AI Startup</h4>
                            <p>Tech innovation</p>
                        </div>
                        <div class="template-card" onclick="loadTemplate('fantasy')">
                            <div class="template-icon">‚öîÔ∏è</div>
                            <h4>Fantasy RPG</h4>
                            <p>Game landing page</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- HISTORY TAB -->
            <div id="tab-history" class="tab-content">
                <div class="control-group">
                    <label>RECENT GENERATIONS</label>
                    <div id="historyList" class="history-list">
                        <p style="opacity: 0.5; text-align: center; padding: 20px;">No history yet. Generate your first site!</p>
                    </div>
                </div>
                <button class="action-btn" onclick="clearHistory()" style="width: 100%; margin-top: 10px;">
                    <i class="fas fa-trash"></i> Clear History
                </button>
            </div>
        </aside>

        <!-- Preview Area -->
        <main class="preview-area" id="mainPreview">
            <div class="preview-header">
                <span>LIVE PREVIEW</span>
                <div class="preview-actions">
                    <div class="device-toggles">
                        <button class="active">Desktop</button>
                        <button>Mobile</button>
                    </div>
                    <button class="icon-btn" onclick="toggleFullScreen()" title="Full Screen">
                        <i class="fas fa-expand"></i>
                    </button>
                    <button class="icon-btn" onclick="copyCode()" title="Copy Code">
                        <i class="fas fa-copy"></i>
                    </button>
                    <button class="icon-btn" onclick="toggleCodeEditor()" title="Edit & Chat">
                        <i class="fas fa-robot"></i>
                    </button>
                    <button class="icon-btn" onclick="refreshPreview()" title="Refresh">
                        <i class="fas fa-rotate-right"></i>
                    </button>
                </div>
            </div>
            
            <!-- The Magic Canvas where code is injected -->
            <div class="frame-container">
                <iframe id="previewFrame"></iframe>
            </div>
            
            <!-- AI Console Output -->
            <div id="ai-terminal"></div>

            <!-- AI Chat Editor (Replaces simple Code Editor) -->
            <div id="codeEditor" class="code-editor">
                <div class="editor-header">
                    <span>AI DESIGN ASSISTANT</span>
                    <button onclick="toggleCodeEditor()" class="close-btn">&times;</button>
                </div>
                
                <div class="ai-edit-container">
                    <!-- Chat Area -->
                    <div id="editChatHistory" class="edit-chat-history">
                        <div class="system-msg">Hi! I can edit this page for you. Just tell me what to change. e.g. "Make the header blue" or "Add a contact section".</div>
                    </div>
                    
                    <!-- Input Area -->
                    <div class="edit-input-area">
                        <input type="text" id="editPromptInput" placeholder="Type your edit request..." onkeypress="handleEditInput(event)">
                        <button onclick="submitEditRequest()">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>

                <!-- Hidden Code View (Toggleable if needed, but keeping simple for now) -->
                <textarea id="codeTextarea" style="display: none;"></textarea>
                <div class="editor-footer">
                    <button onclick="toggleRawCode()" class="secondary-btn" style="font-size: 10px; padding: 5px 10px;">View Raw Code</button>
                </div>
            </div>
        </main>

    </div>

    <!-- Load Project Modal -->
    <div id="loadModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Load Project</h3>
                <button onclick="closeLoadModal()" class="close-btn">&times;</button>
            </div>
            <div id="savedProjectsList" class="saved-projects-list">
                <p style="opacity: 0.5; text-align: center; padding: 20px;">No saved projects</p>
            </div>
        </div>
    </div>

    <script src="knowledge_base.js"></script>
    <script src="generator.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/js/all.min.js"></script>
</body>
</html>
